replicaCount: 1

image:
  repository: ghcr.io/ppiankov/tote
  tag: "0.4.0"
  pullPolicy: IfNotPresent

imagePullSecrets: []

resources:
  requests:
    cpu: 50m
    memory: 64Mi
  limits:
    cpu: 200m
    memory: 128Mi

nodeSelector: {}
tolerations: []
affinity: {}

serviceAccount:
  create: true
  # Override the service account name. Defaults to the release fullname.
  name: ""
  annotations: {}

rbac:
  create: true

# Operator runtime configuration (mapped to CLI flags).
config:
  # Global kill switch. Set to false to disable all detection.
  enabled: true
  # Bind address for Prometheus metrics endpoint.
  metricsAddr: ":8080"
  # Output logs in JSON format (default: text/console).
  jsonLog: false

# Controller salvage settings.
controller:
  maxConcurrentSalvages: 2
  sessionTTL: "5m0s"
  agentGRPCPort: 9090
  # Backup registry for pushing salvaged images. Empty = disabled.
  backupRegistry: ""
  # Name of dockerconfigjson Secret with backup registry credentials.
  backupRegistrySecret: ""
  # Allow HTTP connections to backup registry.
  backupRegistryInsecure: false
  # TTL for completed SalvageRecords (Go duration).
  salvageRecordTTL: "168h"

# Webhook notifications.
notifications:
  # URL to POST event payloads to (empty = disabled).
  webhookUrl: ""
  # Comma-separated event types: detected, salvaged, salvage_failed, pushed, push_failed.
  events: ""

# mTLS for gRPC communication between controller and agents.
# Requires a Kubernetes TLS Secret with ca.crt, tls.crt, tls.key.
# Compatible with cert-manager Certificate resources.
tls:
  enabled: false
  # Name of the Secret containing TLS certs. Must exist in the release namespace.
  secretName: ""

# Grafana dashboard ConfigMap (requires Grafana sidecar).
dashboard:
  enabled: true

# PodDisruptionBudget for the controller.
pdb:
  enabled: false

# NetworkPolicy for controller and agents.
networkPolicy:
  enabled: false

# Annotation validation webhook (optional, fail-open).
webhook:
  enabled: false

# Agent DaemonSet configuration.
agent:
  enabled: true
  containerdSocket: /run/containerd/containerd.sock
  grpcPort: 9090
  metricsAddr: ":8081"
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 256Mi
